{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"bg-gray-900 text-white min-h-screen py-6 sm:py-8 lg:py-12\"\n};\nconst _hoisted_2 = {\n  class: \"max-w-md mx-auto mt-8\"\n};\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"h1\", {\n  class: \"text-3xl font-bold mb-4\"\n}, \"Checkout\", -1 /* HOISTED */);\nconst _hoisted_4 = {\n  class: \"mb-4\"\n};\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"text-2xl font-bold mb-2\"\n}, \"Order Details\", -1 /* HOISTED */);\nconst _hoisted_6 = {\n  class: \"border-collapse border border-gray-800 w-full\"\n};\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", {\n  class: \"bg-gray-800 text-white\"\n}, [/*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"py-2 px-4\"\n}, \"Photo\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"py-2 px-4\"\n}, \"Size\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"py-2 px-4\"\n}, \"Quantity\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"py-2 px-4\"\n}, \"Subtotal\")])], -1 /* HOISTED */);\nconst _hoisted_8 = {\n  class: \"py-2 px-4\"\n};\nconst _hoisted_9 = {\n  class: \"py-2 px-4\"\n};\nconst _hoisted_10 = {\n  class: \"py-2 px-4\"\n};\nconst _hoisted_11 = {\n  class: \"py-2 px-4\"\n};\nconst _hoisted_12 = {\n  class: \"text-xl font-bold mb-2\"\n};\nconst _hoisted_13 = {\n  class: \"mb-4\"\n};\nconst _hoisted_14 = {\n  class: \"border border-gray-800 p-4\"\n};\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"text-2xl font-bold mb-2\"\n}, \"Shipping Information\", -1 /* HOISTED */);\nconst _hoisted_16 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"font-bold\"\n}, \"Street:\", -1 /* HOISTED */);\nconst _hoisted_17 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"font-bold\"\n}, \"Postal Code:\", -1 /* HOISTED */);\nconst _hoisted_18 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"font-bold\"\n}, \"City:\", -1 /* HOISTED */);\nconst _hoisted_19 = /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"font-bold\"\n}, \"Country:\", -1 /* HOISTED */);\nconst _hoisted_20 = {\n  class: \"mb-4\"\n};\nconst _hoisted_21 = {\n  class: \"border border-gray-800 p-4\"\n};\nconst _hoisted_22 = /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"text-2xl font-bold mb-2\"\n}, \"Bank Information\", -1 /* HOISTED */);\nconst _hoisted_23 = /*#__PURE__*/_createElementVNode(\"label\", {\n  for: \"bankInfo\",\n  class: \"block text-white mb-2\"\n}, \"Enter Bank Information:\", -1 /* HOISTED */);\nconst _hoisted_24 = /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\"\n}, \"Place Order\", -1 /* HOISTED */);\nconst _hoisted_25 = /*#__PURE__*/_createStaticVNode(\"<br><footer class=\\\"py-4 bg-gray-800 flex flex-col justify-center items-center\\\"><div class=\\\"flex justify-center items-center mb-4\\\"><a class=\\\"hover:text-gray-300\\\" href=\\\"https://www.instagram.com/marvin.trvl\\\">Contact Us</a><span class=\\\"mx-2 text-gray-400\\\">|</span><a class=\\\"hover:text-gray-300\\\" href=\\\"https://www.instagram.com/marvin.trvl\\\">Impressum</a><span class=\\\"mx-2 text-gray-400\\\">|</span><a class=\\\"hover:text-gray-300\\\" href=\\\"https://www.instagram.com/marvin.trvl\\\">Instagram</a></div><div class=\\\"text-gray-400\\\">Â© 2023 SnapStock Licensing &amp; Prints</div></footer>\", 2);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _createElementVNode(\"table\", _hoisted_6, [_hoisted_7, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.cartItems, item => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: item.id\n    }, [_createElementVNode(\"td\", _hoisted_8, _toDisplayString(item.photo.name), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_9, _toDisplayString(item.photo.size), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_10, _toDisplayString(item.quantity), 1 /* TEXT */), _createElementVNode(\"td\", _hoisted_11, \"$\" + _toDisplayString(item.photo.price), 1 /* TEXT */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])]), _createElementVNode(\"p\", _hoisted_12, \"Total: $\" + _toDisplayString($data.cartTotal), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_hoisted_15, _createCommentVNode(\" Display user's shipping information \"), _createElementVNode(\"p\", null, [_hoisted_16, _createTextVNode(\" \" + _toDisplayString($data.user.street), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_17, _createTextVNode(\" \" + _toDisplayString($data.user.postal_code), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_18, _createTextVNode(\" \" + _toDisplayString($data.user.city), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_hoisted_19, _createTextVNode(\" \" + _toDisplayString($data.user.country), 1 /* TEXT */)])])]), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, [_hoisted_22, _createCommentVNode(\" Allow the user to enter bank information \"), _createElementVNode(\"form\", {\n    onSubmit: _cache[1] || (_cache[1] = _withModifiers((...args) => $options.placeOrder && $options.placeOrder(...args), [\"prevent\"]))\n  }, [_hoisted_23, _withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.bankInfo = $event),\n    name: \"bankInfo\",\n    class: \"rounded-md px-4 py-2 w-full bg-gray-800 text-white resize-none\",\n    maxlength: \"30\",\n    rows: \"1\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.bankInfo]]), _hoisted_24], 32 /* NEED_HYDRATION */)])])]), _hoisted_25]);\n}","map":{"version":3,"names":["class","_createElementVNode","for","type","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_Fragment","_renderList","$data","cartItems","item","key","id","_hoisted_8","_toDisplayString","photo","name","_hoisted_9","size","_hoisted_10","quantity","_hoisted_11","price","_hoisted_12","cartTotal","_hoisted_13","_hoisted_14","_hoisted_15","_createCommentVNode","_hoisted_16","user","street","_hoisted_17","postal_code","_hoisted_18","city","_hoisted_19","country","_hoisted_20","_hoisted_21","_hoisted_22","onSubmit","_cache","_withModifiers","args","$options","placeOrder","_hoisted_23","bankInfo","$event","maxlength","rows","required","_hoisted_24","_hoisted_25"],"sources":["C:\\Users\\menzm\\Desktop\\SCC_Project\\frontend\\src\\views\\CheckoutView.vue"],"sourcesContent":["<template>\r\n  <div class=\"bg-gray-900 text-white min-h-screen py-6 sm:py-8 lg:py-12\">\r\n  <div class=\"max-w-md mx-auto mt-8\">\r\n    <h1 class=\"text-3xl font-bold mb-4\">Checkout</h1>\r\n\r\n    <div class=\"mb-4\">\r\n      <h2 class=\"text-2xl font-bold mb-2\">Order Details</h2>\r\n      <table class=\"border-collapse border border-gray-800 w-full\">\r\n        <thead>\r\n          <tr class=\"bg-gray-800 text-white\">\r\n            <th class=\"py-2 px-4\">Photo</th>\r\n            <th class=\"py-2 px-4\">Size</th>\r\n            <th class=\"py-2 px-4\">Quantity</th>\r\n            <th class=\"py-2 px-4\">Subtotal</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"item in cartItems\" :key=\"item.id\">\r\n            <td class=\"py-2 px-4\">{{ item.photo.name }}</td>\r\n            <td class=\"py-2 px-4\">{{ item.photo.size }}</td>\r\n            <td class=\"py-2 px-4\">{{ item.quantity }}</td>\r\n            <td class=\"py-2 px-4\">${{ item.photo.price }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <p class=\"text-xl font-bold mb-2\">Total: ${{ cartTotal }}</p>\r\n\r\n    <div class=\"mb-4\">\r\n      <div class=\"border border-gray-800 p-4\">\r\n        <h2 class=\"text-2xl font-bold mb-2\">Shipping Information</h2>\r\n        <!-- Display user's shipping information -->\r\n        <p><span class=\"font-bold\">Street:</span> {{ user.street }}</p>\r\n        <p><span class=\"font-bold\">Postal Code:</span> {{ user.postal_code }}</p>\r\n        <p><span class=\"font-bold\">City:</span> {{ user.city }}</p>\r\n        <p><span class=\"font-bold\">Country:</span> {{ user.country }}</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"mb-4\">\r\n      <div class=\"border border-gray-800 p-4\">\r\n        <h2 class=\"text-2xl font-bold mb-2\">Bank Information</h2>\r\n        <!-- Allow the user to enter bank information -->\r\n        <form @submit.prevent=\"placeOrder\">\r\n          <label for=\"bankInfo\" class=\"block text-white mb-2\">Enter Bank Information:</label>\r\n          <textarea v-model=\"bankInfo\" name=\"bankInfo\" class=\"rounded-md px-4 py-2 w-full bg-gray-800 text-white resize-none\" maxlength=\"30\" rows=\"1\" required></textarea>\r\n          <button type=\"submit\" class=\"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\">Place Order</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <br>\r\n    <footer class=\"py-4 bg-gray-800 flex flex-col justify-center items-center\">\r\n      <div class=\"flex justify-center items-center mb-4\">\r\n        <a class=\"hover:text-gray-300\" href=\"https://www.instagram.com/marvin.trvl\">Contact Us</a>\r\n        <span class=\"mx-2 text-gray-400\">|</span>\r\n        <a class=\"hover:text-gray-300\" href=\"https://www.instagram.com/marvin.trvl\">Impressum</a>\r\n        <span class=\"mx-2 text-gray-400\">|</span>\r\n        <a class=\"hover:text-gray-300\" href=\"https://www.instagram.com/marvin.trvl\">Instagram</a>\r\n      </div>\r\n      <div class=\"text-gray-400\">&copy; 2023 SnapStock Licensing & Prints</div>\r\n    </footer>\r\n</div>\r\n</template>\r\n\r\n<script>\r\n  import axios from 'axios';\r\n\r\n  export default {\r\n    data() {\r\n      return {\r\n        cartItems: [],\r\n        cartTotal: 0,\r\n        user: {},\r\n        bankInfo: '',\r\n      };\r\n    },\r\n    methods: {\r\n      fetchCartItems() {\r\n        axios.get('http://127.0.0.1:5002/get-cart', {\r\n          headers: {\r\n            Authorization: `Bearer ${this.$store.state.authToken}`,\r\n          },\r\n        })\r\n          .then(response => {\r\n            // Log raw API response \r\n            console.log('API Response:', response.data);\r\n\r\n            const cartItems = response.data.cart_items;\r\n            console.log('First Item:', cartItems[0]);\r\n            const firstItem = cartItems[0];\r\n            console.log('First item photo ID:', firstItem.photo_id);\r\n\r\n            // Log cart items separately \r\n            console.log('Cart Items:', cartItems);\r\n\r\n            this.cartItems = cartItems;\r\n            this.cartTotal = response.data.total_price;\r\n          })\r\n          .catch(error => {\r\n            console.error('Error fetching cart items:', error);\r\n          });\r\n      },\r\n      fetchUserInfo() {\r\n        axios.get('http://127.0.0.1:5000/profile', {\r\n          headers: {\r\n            Authorization: `Bearer ${this.$store.state.authToken}`,\r\n          },\r\n        })\r\n          .then(response => {\r\n            this.user = response.data;\r\n          })\r\n          .catch(error => {\r\n            console.error('Error fetching user information:', error);\r\n          });\r\n      },\r\n      placeOrder() {\r\n        const orderDetails = this.cartItems.map(item => {\r\n          if (item.photo) {\r\n            return {\r\n              quantity: item.quantity,\r\n              size: item.photo.size,\r\n              photo_name: item.photo.name,\r\n              photo_id: item.photo_id,  // Corrected from item.photo_id\r\n              subtotal: item.photo.price,\r\n            };\r\n          } else {\r\n            console.error('Item photo is undefined:', item);\r\n            return null;\r\n          }\r\n        }).filter(orderDetail => orderDetail !== null);\r\n\r\n        const orderData = {\r\n          total_price: this.cartTotal,\r\n          shipping_address: `${this.user.street}, ${this.user.postal_code}, ${this.user.city}, ${this.user.country}`,\r\n          bank_info: this.bankInfo,\r\n          order_details: orderDetails,\r\n        };\r\n\r\n        axios.post('http://127.0.0.1:5004/place-order', orderData, {\r\n          headers: {\r\n            Authorization: `Bearer ${this.$store.state.authToken}`,\r\n          },\r\n        })\r\n          .then(response => {\r\n            console.log('Order placed successfully:', response.data);\r\n\r\n            this.$router.push({\r\n              name: 'OrderSuccessView',\r\n              params: { orderId: response.data.order_id }\r\n            });\r\n            // Clear the user's cart after placing the order\r\n            axios.delete('http://127.0.0.1:5002/clear-cart', {\r\n              headers: {\r\n                Authorization: `Bearer ${this.$store.state.authToken}`,\r\n              },\r\n            })\r\n              .then(clearResponse => {\r\n                console.log('Cart cleared successfully:', clearResponse.data);\r\n                // Optionally, you can navigate to a thank you page or perform other actions\r\n              })\r\n              .catch(clearError => {\r\n                console.error('Error clearing cart:', clearError);\r\n                // Handle error while clearing the cart\r\n              });\r\n          })\r\n          .catch(error => {\r\n            console.error('Error placing order:', error);\r\n            // Handle error, show a message to the user, etc.\r\n          });\r\n      },\r\n    },\r\n\r\n    created() {\r\n      this.fetchCartItems();\r\n      this.fetchUserInfo();\r\n    },\r\n  };\r\n</script>\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}