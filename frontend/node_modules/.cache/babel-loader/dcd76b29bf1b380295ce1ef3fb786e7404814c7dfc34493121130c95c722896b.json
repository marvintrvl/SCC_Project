{"ast":null,"code":"import axios from 'axios';\nexport default {\n  data() {\n    return {\n      cartItems: [],\n      cartTotal: 0,\n      user: {},\n      bankInfo: ''\n    };\n  },\n  methods: {\n    fetchCartItems() {\n      axios.get('http://127.0.0.1:5002/get-cart', {\n        headers: {\n          Authorization: `Bearer ${this.$store.state.authToken}`\n        }\n      }).then(response => {\n        this.cartItems = response.data.cart_items;\n        this.cartTotal = response.data.total_price;\n      }).catch(error => {\n        console.error('Error fetching cart items:', error);\n      });\n    },\n    fetchUserInfo() {\n      axios.get('http://127.0.0.1:5000/profile', {\n        headers: {\n          Authorization: `Bearer ${this.$store.state.authToken}`\n        }\n      }).then(response => {\n        this.user = response.data;\n      }).catch(error => {\n        console.error('Error fetching user information:', error);\n      });\n    },\n    placeOrder() {\n      const orderDetails = this.cartItems.map(item => {\n        if (item.photo) {\n          return {\n            quantity: item.quantity,\n            size: item.photo.size,\n            photo_name: item.photo.name,\n            photo_id: item.photo.id,\n            subtotal: item.photo.price * item.quantity\n          };\n        } else {\n          // Handle the case where item.photo is undefined\n          console.error('Item photo is undefined:', item);\n          return null; // or handle it in a way that suits your application\n        }\n      }).filter(orderDetail => orderDetail !== null);\n      console.log('Order details:', orderDetails);\n      const orderData = {\n        total_price: this.cartTotal,\n        shipping_address: `${this.user.street}, ${this.user.postal_code}, ${this.user.city}, ${this.user.country}`,\n        bank_info: this.bankInfo,\n        order_details: orderDetails\n      };\n      console.log('Order data:', orderData);\n      axios.post('http://127.0.0.1:5004/place-order', orderData, {\n        headers: {\n          Authorization: `Bearer ${this.$store.state.authToken}`\n        }\n      }).then(response => {\n        console.log('Order placed successfully:', response.data);\n        // Optionally, you can handle success and navigate to a thank you page\n      }).catch(error => {\n        console.error('Error placing order:', error);\n        // Handle error, show a message to the user, etc.\n      });\n    }\n  },\n  created() {\n    this.fetchCartItems();\n    this.fetchUserInfo();\n  }\n};","map":{"version":3,"names":["axios","data","cartItems","cartTotal","user","bankInfo","methods","fetchCartItems","get","headers","Authorization","$store","state","authToken","then","response","cart_items","total_price","catch","error","console","fetchUserInfo","placeOrder","orderDetails","map","item","photo","quantity","size","photo_name","name","photo_id","id","subtotal","price","filter","orderDetail","log","orderData","shipping_address","street","postal_code","city","country","bank_info","order_details","post","created"],"sources":["C:\\Users\\menzm\\Desktop\\SCC_Project\\frontend\\src\\views\\CheckoutView.vue"],"sourcesContent":["<template>\r\n  <div class=\"max-w-md mx-auto mt-8\">\r\n    <h1 class=\"text-3xl font-bold mb-4\">Checkout</h1>\r\n\r\n    <div class=\"mb-4\">\r\n      <h2 class=\"text-2xl font-bold mb-2\">Order Details</h2>\r\n      <table class=\"border-collapse border border-gray-800 w-full\">\r\n        <thead>\r\n          <tr class=\"bg-gray-800 text-white\">\r\n            <th class=\"py-2 px-4\">Photo</th>\r\n            <th class=\"py-2 px-4\">Size</th>\r\n            <th class=\"py-2 px-4\">Quantity</th>\r\n            <th class=\"py-2 px-4\">Subtotal</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr v-for=\"item in cartItems\" :key=\"item.id\">\r\n            <td class=\"py-2 px-4\">{{ item.photo.name }}</td>\r\n            <td class=\"py-2 px-4\">{{ item.photo.size }}</td>\r\n            <td class=\"py-2 px-4\">{{ item.quantity }}</td>\r\n            <td class=\"py-2 px-4\">${{ item.photo.price * item.quantity }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <p class=\"text-xl font-bold mb-2\">Total: ${{ cartTotal }}</p>\r\n\r\n    <div class=\"mb-4\">\r\n      <div class=\"border border-gray-800 p-4\">\r\n        <h2 class=\"text-2xl font-bold mb-2\">Shipping Information</h2>\r\n        <!-- Display user's shipping information -->\r\n        <p><span class=\"font-bold\">Street:</span> {{ user.street }}</p>\r\n        <p><span class=\"font-bold\">Postal Code:</span> {{ user.postal_code }}</p>\r\n        <p><span class=\"font-bold\">City:</span> {{ user.city }}</p>\r\n        <p><span class=\"font-bold\">Country:</span> {{ user.country }}</p>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"mb-4\">\r\n      <div class=\"border border-gray-800 p-4\">\r\n        <h2 class=\"text-2xl font-bold mb-2\">Bank Information</h2>\r\n        <!-- Allow the user to enter bank information -->\r\n        <form @submit.prevent=\"placeOrder\">\r\n          <label for=\"bankInfo\" class=\"block text-white mb-2\">Enter Bank Information:</label>\r\n          <textarea v-model=\"bankInfo\" name=\"bankInfo\" class=\"rounded-md px-4 py-2 w-full bg-gray-800 text-white resize-none\" maxlength=\"30\" rows=\"1\" required></textarea>\r\n          <button type=\"submit\" class=\"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded\">Place Order</button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      cartItems: [],\r\n      cartTotal: 0,\r\n      user: {},\r\n      bankInfo: '',\r\n    };\r\n  },\r\n  methods: {\r\n    fetchCartItems() {\r\n      axios.get('http://127.0.0.1:5002/get-cart', {\r\n        headers: {\r\n          Authorization: `Bearer ${this.$store.state.authToken}`,\r\n        },\r\n      })\r\n        .then(response => {\r\n          this.cartItems = response.data.cart_items;\r\n          this.cartTotal = response.data.total_price;\r\n        })\r\n        .catch(error => {\r\n          console.error('Error fetching cart items:', error);\r\n        });\r\n    },\r\n    fetchUserInfo() {\r\n      axios.get('http://127.0.0.1:5000/profile', {\r\n        headers: {\r\n          Authorization: `Bearer ${this.$store.state.authToken}`,\r\n        },\r\n      })\r\n        .then(response => {\r\n          this.user = response.data;\r\n        })\r\n        .catch(error => {\r\n          console.error('Error fetching user information:', error);\r\n        });\r\n    },\r\n    placeOrder() {\r\n      const orderDetails = this.cartItems.map(item => {\r\n        if (item.photo) {\r\n          return {\r\n            quantity: item.quantity,\r\n            size: item.photo.size,\r\n            photo_name: item.photo.name,\r\n            photo_id: item.photo.id,\r\n            subtotal: item.photo.price * item.quantity,\r\n          };\r\n        } else {\r\n          // Handle the case where item.photo is undefined\r\n          console.error('Item photo is undefined:', item);\r\n          return null;  // or handle it in a way that suits your application\r\n        }\r\n      }).filter(orderDetail => orderDetail !== null);\r\n\r\n      console.log('Order details:', orderDetails);\r\n\r\n      const orderData = {\r\n        total_price: this.cartTotal,\r\n        shipping_address: `${this.user.street}, ${this.user.postal_code}, ${this.user.city}, ${this.user.country}`,\r\n        bank_info: this.bankInfo,\r\n        order_details: orderDetails,\r\n      };\r\n\r\n      console.log('Order data:', orderData);\r\n\r\n      axios.post('http://127.0.0.1:5004/place-order', orderData, {\r\n        headers: {\r\n          Authorization: `Bearer ${this.$store.state.authToken}`,\r\n        },\r\n      })\r\n        .then(response => {\r\n          console.log('Order placed successfully:', response.data);\r\n          // Optionally, you can handle success and navigate to a thank you page\r\n        })\r\n        .catch(error => {\r\n          console.error('Error placing order:', error);\r\n          // Handle error, show a message to the user, etc.\r\n        });\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchCartItems();\r\n    this.fetchUserInfo();\r\n  },\r\n};\r\n</script>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}